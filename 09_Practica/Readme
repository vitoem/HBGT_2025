# Carpeta /Practica09
#
#--------------------------------------------
#Ejercicio-01
#--------------------------------------------

#Copie o genere un link simbolico en su directorio actual hacia los archivos resultantes de la Practica08, es decir, los transcriptomas ensamblados generados con Mira y Trinity.

ln -s ../Practica08/2.MiraAssembly/Mira_assembly/Mira_d_results/Mira_out.unpadded.fasta Mira.fasta
ln -s ../Practica08/3.TrinityAssembly/trinity_out_dir.Trinity.fasta Trinity.fasta

#Utilice el script de perl "fastx-length.pl" (https://github.com/gringer/bioinfscripts/blob/master/fastx-length.pl) para calcular algunas metricas/estadisticas simples.

./fastx-length.pl Mira.fasta >Temp 2>MiraStat01.txt
./fastx-length.pl Trinity.fasta >Temp 2>TrinityStat01.txt

#Analice los resultados... Note que el umbral del tamaño en las secuencias resultantes tras el proceso de ensamblado, es distinto en ambos ensambladores. Utilice la herramienta seqclean para eliminar secuencias <200, recorte además en aquellas secuencias que los contengan elementos como: colas poly A/T, secuencias de baja complejidad y secuencias terminales rincas en bases indeterminadas (Ns). Revise el archivo de ayuda del programa seqclean para tal proposito. Al término genere nuevas métricas y compare ambos resultados.

sbatch SeqClean.slurm

./fastx-length.pl Mira.fasta.clean >Temp 2>MiraStat02.txt
./fastx-length.pl Trinity.fasta.clean >Temp 2>TrinityStat02.txt

#--------------------------------------------
#Ejercicio-02
#--------------------------------------------

#Identifique marcos de lectura abiertos al interior de las contigs (unigenes) resultantes de los procesos de ensamblados.
#Utilice la herramienta "getorf" disponible en el kit de herramientas de Emboss (http://emboss.sourceforge.net/). Para dicho proposito ejecute getORF.slurm. Antes de ejecutar la tarea, visualice el contenido de dicho archvio (getORF.slurm) cargue el modulo correspondiente y lea el archivo de ayuda para interpretar las variables utilizadas

#EMBOSS

module purge

module load emboss/6.6.0/gcc/8.3.1-7aag
getorf --help
sbatch getORF.slurm

#Analice los archivos resultantes y compare

--------------------------------------------
Ejercicio-03
--------------------------------------------

#Para generar un archivo que contenga la secuencia proteica que corresponde al ORF mas largo identificado en cada transcrito o unigene, ejecute el script de perl tranlate2aa.pl (descargado de GitHub). El script antes mencionado requiere emboss (utiliza getOrf) y algunas bibliotecas de bioperl, por lo que debe asegurese de cargar los modulos correspondientes cuando ejecuta el script en la línea de comandos. Puede realizar esta tarea utilizando el archivo generado para el gestor de tareas (Translate.slurm).

#Ejecute preferentemente la tarea de la siguiente manera (tiempo aproximado 25 min)

sbatch Translate.slurm

#Estime las metricas para los archivos recientemente generados y compare las salidas

./fastx-length.pl TrinityORFsTranslated.fasta > MetricasTrinityPRT.txt
./fastx-length.pl MiraORFsTranslated.fasta > MetricasMiraPRT.txt

